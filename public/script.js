function hasConsentFor(e){return void 0!==window.CookieConsent&&window.CookieConsent.validConsent(e)}function withConsent(e,t){hasConsentFor(e)?t():console.log(`[WARNING] Skipping ${e} code - no user consent`)}function getApiBase(){var e=(window.ZAPPY_API_BASE||"").replace(/\/$/,""),t=window.location?window.location.pathname:"";return-1!==t.indexOf("/preview")||-1!==t.indexOf("/preview-fullscreen")?window.location.origin:e}function buildApiUrl(e){"/"!==e.charAt(0)&&(e="/"+e);var t=getApiBase();return t?t+e:e}async function loadFeaturedProducts(){const e=document.getElementById("zappy-featured-products");if(!e)return;const t=window.ZAPPY_WEBSITE_ID;if(!t)return;const n={products:"××•×¦×¨×™×",ourProducts:"×”××•×¦×¨×™× ×©×œ× ×•",featuredProducts:"××•×¦×¨×™× ××•××œ×¦×™×",noFeaturedProducts:"×¢×•×“ ×œ× × ×‘×—×¨×• ××•×¦×¨×™× ××•××œ×¦×™×. ×¦×¤×• ×‘×›×œ ×”××•×¦×¨×™× ×©×œ× ×•!",featuredCategories:"×§× ×• ×œ×¤×™ ×§×˜×’×•×¨×™×”",all:"×”×›×œ",featured:"××•××œ×¦×™×",new:"×—×“×©×™×",sale:"××‘×¦×¢×™×",loadingProducts:"×˜×•×¢×Ÿ ××•×¦×¨×™×...",cart:"×¢×’×œ×ª ×§× ×™×•×ª",yourCart:"×¢×’×œ×ª ×”×§× ×™×•×ª ×©×œ×š",emptyCart:"×”×¢×’×œ×” ×¨×™×§×”",total:'×¡×”"×›',proceedToCheckout:"×”××©×š ×œ×ª×©×œ×•×",checkout:"×ª×©×œ×•×",customerInfo:"×¤×¨×˜×™ ×œ×§×•×—",fullName:"×©× ××œ×",email:"××™××™×™×œ",phone:"×˜×œ×¤×•×Ÿ",shippingAddress:"×›×ª×•×‘×ª ×œ××©×œ×•×—",street:"×¨×—×•×‘ ×•××¡×¤×¨",apartment:"×“×™×¨×”, ×§×•××”, ×›× ×™×¡×”",city:"×¢×™×¨",zip:"××™×§×•×“",shippingMethod:"×©×™×˜×ª ××©×œ×•×—",loadingShipping:"×˜×•×¢×Ÿ ×©×™×˜×•×ª ××©×œ×•×—...",payment:"×ª×©×œ×•×",loadingPayment:"×˜×•×¢×Ÿ ××¤×©×¨×•×™×•×ª ×ª×©×œ×•×...",orderSummary:"×¡×™×›×•× ×”×–×× ×”",subtotal:"×¡×›×•× ×‘×™× ×™×™×",vat:'××¢"×',vatIncluded:'×›×•×œ×œ ××¢"×',shipping:"××©×œ×•×—",discount:"×”× ×—×”",totalToPay:'×¡×”"×› ×œ×ª×©×œ×•×',placeOrder:"×‘×¦×¢ ×”×–×× ×”",login:"×”×ª×—×‘×¨×•×ª",customerLogin:"×”×ª×—×‘×¨×•×ª ×œ×§×•×—×•×ª",enterEmail:"×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”××™××™×™×œ ×©×œ×š ×•× ×©×œ×— ×œ×š ×§×•×“ ×”×ª×—×‘×¨×•×ª",emailAddress:"×›×ª×•×‘×ª ××™××™×™×œ",sendCode:"×©×œ×— ×§×•×“",enterCode:"×”×–×Ÿ ××ª ×”×§×•×“ ×©× ×©×œ×— ×œ××™××™×™×œ ×©×œ×š",verificationCode:"×§×•×“ ××™××•×ª",verify:"×××ª",returnPolicy:"××“×™× ×™×•×ª ×”×—×–×¨×•×ª",addToCart:"×”×•×¡×£ ×œ×¢×’×œ×”",addedToCart:"×”××•×¦×¨ × ×•×¡×£ ×œ×¢×’×œ×”!",remove:"×”×¡×¨",noProducts:"××™×Ÿ ××•×¦×¨×™× ×œ×”×¦×’×” ×›×¨×’×¢",errorLoading:"×©×’×™××” ×‘×˜×¢×™× ×”",days:"×™××™×",currency:"â‚ª",free:"×—×™× ×",freeAbove:"××©×œ×•×— ×—×™× × ××¢×œ",noShippingMethods:"××™×Ÿ ××¤×©×¨×•×™×•×ª ××©×œ×•×— ×–××™× ×•×ª",viewAllResults:"×”×¦×’ ××ª ×›×œ ×”×ª×•×¦××•×ª",searchProducts:"×—×™×¤×•×© ××•×¦×¨×™×",productDetails:"×¤×¨×˜×™ ×”××•×¦×¨",viewDetails:"×œ×¤×¨×˜×™× × ×•×¡×¤×™×",inStock:"×‘××œ××™",outOfStock:"××–×œ ××”××œ××™",sku:'××§"×˜',category:"×§×˜×’×•×¨×™×”",relatedProducts:"××•×¦×¨×™× ×“×•××™×",productNotFound:"×”××•×¦×¨ ×œ× × ××¦×",backToProducts:"×—×–×¨×” ×œ××•×¦×¨×™×",quantity:"×›××•×ª",couponCode:"×§×•×“ ×§×•×¤×•×Ÿ",enterCouponCode:"×”×–×Ÿ ×§×•×“ ×§×•×¤×•×Ÿ",applyCoupon:"×”×—×œ",removeCoupon:"×”×¡×¨",couponApplied:"×”×§×•×¤×•×Ÿ ×”×•×—×œ ×‘×”×¦×œ×—×”!",invalidCoupon:"×§×•×“ ×§×•×¤×•×Ÿ ×œ× ×ª×§×™×Ÿ",couponExpired:"×”×§×•×¤×•×Ÿ ×¤×’ ×ª×•×§×£",couponMinOrder:"×¡×›×•× ×”×–×× ×” ××™× ×™××œ×™",alreadyHaveAccount:"×›×‘×¨ ×™×© ×œ×š ×—×©×‘×•×Ÿ?",loginHere:"×”×ª×—×‘×¨ ×›××Ÿ",loggedInAs:"××—×•×‘×¨ ×›:",logout:"×”×ª× ×ª×§",haveCouponCode:"×™×© ×œ×™ ×§×•×“ ×§×•×¤×•×Ÿ",orderSuccess:"×”×”×–×× ×” ×”×ª×§×‘×œ×”!",thankYouOrder:"×ª×•×“×” ×¢×œ ×”×”×–×× ×”",orderNumber:"××¡×¤×¨ ×”×–×× ×”",orderConfirmation:"××™×©×•×¨ ×”×–×× ×” × ×©×œ×— ×œ××™××™×™×œ ×©×œ×š",orderProcessing:"×”×”×–×× ×” ×©×œ×š ×‘×˜×™×¤×•×œ. × ×¢×“×›×Ÿ ××•×ª×š ×›×©×”××©×œ×•×— ×™×¦× ×œ×“×¨×š.",continueShopping:"×œ×”××©×š ×§× ×™×•×ª",orderDetails:"×¤×¨×˜×™ ×”×”×–×× ×”",loadingOrder:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×”×–×× ×”...",orderNotFound:"×œ× × ××¦××” ×”×–×× ×”",orderItems:"×¤×¨×™×˜×™× ×‘×”×–×× ×”",paidAmount:"×¡×›×•× ×©×©×•×œ×",myAccount:"×”×—×©×‘×•×Ÿ ×©×œ×™",accountWelcome:"×‘×¨×•×š ×”×‘×",yourOrders:"×”×”×–×× ×•×ª ×©×œ×š",noOrders:"××™×Ÿ ×¢×“×™×™×Ÿ ×”×–×× ×•×ª",orderDate:"×ª××¨×™×š",orderStatus:"×¡×˜×˜×•×¡",orderTotal:'×¡×”"×›',viewOrder:"×¦×¤×” ×‘×”×–×× ×”",statusPending:"×××ª×™×Ÿ ×œ×ª×©×œ×•×",statusPaid:"×©×•×œ×",statusProcessing:"×‘×˜×™×¤×•×œ",statusShipped:"× ×©×œ×—",statusDelivered:"× ××¡×¨",statusCancelled:"×‘×•×˜×œ",notLoggedIn:"×œ× ××—×•×‘×¨",pleaseLogin:"×™×© ×œ×”×ª×—×‘×¨ ×›×“×™ ×œ×¦×¤×•×ª ×‘×—×©×‘×•×Ÿ",selectVariant:"×‘×—×¨ ××¤×©×¨×•×ª",variantUnavailable:"×œ× ×–××™×Ÿ",color:"×¦×‘×¢",size:"××™×“×”",material:"×—×•××¨",style:"×¡×’× ×•×Ÿ",weight:"××©×§×œ",capacity:"×§×™×‘×•×œ×ª",length:"××•×¨×š"};try{const o=await fetch(buildApiUrl("/api/ecommerce/storefront/products?websiteId="+t+"&featured=true&limit=6")),a=await o.json();if(!a.success||!a.data?.length)return void(e.innerHTML='<div class="no-featured-products">'+(n.noFeaturedProducts||"No featured products yet. Check out all our products!")+"</div>");renderProductGrid(e,a.data,n)}catch(t){console.error("Failed to load featured products",t),e.innerHTML='<div class="empty-cart">'+n.errorLoading+"</div>"}}async function loadFeaturedCategories(){const e=document.getElementById("zappy-featured-categories");if(!e)return;const t=window.ZAPPY_WEBSITE_ID;if(t)try{const n=await fetch(buildApiUrl("/api/ecommerce/storefront/featured-categories?websiteId="+t)),o=await n.json();if(!o.success||!o.data?.length){const e=document.getElementById("featured-categories");return void(e&&e.remove())}e.innerHTML=o.data.map(function(e){const t=e.image||"";return'<a href="/products?category='+e.id+'" class="category-block" data-category-id="'+e.id+'"><div class="category-block-bg" style="background-image: url(\''+t+'\')"></div><div class="category-block-overlay"></div><div class="category-block-content"><span class="category-block-name">'+e.name+"</span></div></a>"}).join("")}catch(e){console.error("Failed to load featured categories",e);const t=document.getElementById("featured-categories");t&&t.remove()}}function renderProductGrid(e,t,n){e.innerHTML=t.map(e=>{const t=e.sale_price&&parseFloat(e.sale_price)<parseFloat(e.price),o=t?n.currency+parseFloat(e.sale_price).toFixed(2)+'<span class="original-price">'+n.currency+parseFloat(e.price).toFixed(2)+"</span>":n.currency+parseFloat(e.price).toFixed(2);var a=[];t&&a.push('<span class="product-tag tag-sale">'+n.sale+"</span>");var r=new Date;r.setDate(r.getDate()-30),(e.tags&&e.tags.some(function(e){return"new"===e.toLowerCase()||"×—×“×©"===e.toLowerCase()})||e.created_at&&new Date(e.created_at)>r)&&a.push('<span class="product-tag tag-new">'+n.new+"</span>"),e.is_featured&&a.push('<span class="product-tag tag-featured">'+n.featured+"</span>"),e.tags&&e.tags.length&&e.tags.forEach(function(e){var t=e.toLowerCase();"new"!==t&&"×—×“×©"!==t&&a.push('<span class="product-tag">'+e+"</span>")});var i=a.length>0?'<div class="product-tags">'+a.join("")+"</div>":"";return'<div class="product-card" data-product-id="'+e.id+'">'+i+'<a href="/product/'+(e.slug||e.id)+'" class="product-card-link">'+(e.images?.[0]?'<img src="'+e.images[0]+'" alt="'+e.name+'">':'<div style="height:200px;background:#f0f0f0;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#999;">ğŸ“¦</div>')+"<h3>"+e.name+"</h3><p>"+(e.description||"").substring(0,80)+(e.description?.length>80?"...":"")+'</p><div class="price">'+o+'</div></a><button class="add-to-cart" onclick="event.stopPropagation(); window.zappyHandleAddToCart('+JSON.stringify(e).replace(/"/g,"&quot;")+')">'+n.addToCart+"</button></div>"}).join("")}async function loadCatalogCategories(){const e=document.getElementById("zappy-category-links"),t=document.getElementById("zappy-nav-category-links");if(!e&&!t)return;const n=window.ZAPPY_WEBSITE_ID;if(n)try{const o=await fetch(buildApiUrl("/api/ecommerce/storefront/categories?websiteId="+n)),a=await o.json();if(!a.success||!a.data?.length)return;const r=a.data.map(e=>'<li data-category-id="'+e.id+'"><a href="/products?category='+e.id+'">'+e.name+"</a></li>").join(""),i=a.data.map(e=>'<a href="/products?category='+e.id+'" class="catalog-menu-item" data-category-id="'+e.id+'">'+e.name+"</a>").join("");t&&(t.querySelectorAll("li[data-category-id]").forEach(function(e){e.remove()}),t.insertAdjacentHTML("beforeend",r)),e&&(e.querySelectorAll("[data-category-id]").forEach(function(e){e.remove()}),e.insertAdjacentHTML("beforeend",i))}catch(e){console.error("Failed to load categories",e)}}async function loadProductDetailPage(){const e=document.getElementById("product-detail");if(!e)return;const t=window.ZAPPY_WEBSITE_ID;if(!t)return;const n={products:"××•×¦×¨×™×",ourProducts:"×”××•×¦×¨×™× ×©×œ× ×•",featuredProducts:"××•×¦×¨×™× ××•××œ×¦×™×",noFeaturedProducts:"×¢×•×“ ×œ× × ×‘×—×¨×• ××•×¦×¨×™× ××•××œ×¦×™×. ×¦×¤×• ×‘×›×œ ×”××•×¦×¨×™× ×©×œ× ×•!",featuredCategories:"×§× ×• ×œ×¤×™ ×§×˜×’×•×¨×™×”",all:"×”×›×œ",featured:"××•××œ×¦×™×",new:"×—×“×©×™×",sale:"××‘×¦×¢×™×",loadingProducts:"×˜×•×¢×Ÿ ××•×¦×¨×™×...",cart:"×¢×’×œ×ª ×§× ×™×•×ª",yourCart:"×¢×’×œ×ª ×”×§× ×™×•×ª ×©×œ×š",emptyCart:"×”×¢×’×œ×” ×¨×™×§×”",total:'×¡×”"×›',proceedToCheckout:"×”××©×š ×œ×ª×©×œ×•×",checkout:"×ª×©×œ×•×",customerInfo:"×¤×¨×˜×™ ×œ×§×•×—",fullName:"×©× ××œ×",email:"××™××™×™×œ",phone:"×˜×œ×¤×•×Ÿ",shippingAddress:"×›×ª×•×‘×ª ×œ××©×œ×•×—",street:"×¨×—×•×‘ ×•××¡×¤×¨",apartment:"×“×™×¨×”, ×§×•××”, ×›× ×™×¡×”",city:"×¢×™×¨",zip:"××™×§×•×“",shippingMethod:"×©×™×˜×ª ××©×œ×•×—",loadingShipping:"×˜×•×¢×Ÿ ×©×™×˜×•×ª ××©×œ×•×—...",payment:"×ª×©×œ×•×",loadingPayment:"×˜×•×¢×Ÿ ××¤×©×¨×•×™×•×ª ×ª×©×œ×•×...",orderSummary:"×¡×™×›×•× ×”×–×× ×”",subtotal:"×¡×›×•× ×‘×™× ×™×™×",vat:'××¢"×',vatIncluded:'×›×•×œ×œ ××¢"×',shipping:"××©×œ×•×—",discount:"×”× ×—×”",totalToPay:'×¡×”"×› ×œ×ª×©×œ×•×',placeOrder:"×‘×¦×¢ ×”×–×× ×”",login:"×”×ª×—×‘×¨×•×ª",customerLogin:"×”×ª×—×‘×¨×•×ª ×œ×§×•×—×•×ª",enterEmail:"×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”××™××™×™×œ ×©×œ×š ×•× ×©×œ×— ×œ×š ×§×•×“ ×”×ª×—×‘×¨×•×ª",emailAddress:"×›×ª×•×‘×ª ××™××™×™×œ",sendCode:"×©×œ×— ×§×•×“",enterCode:"×”×–×Ÿ ××ª ×”×§×•×“ ×©× ×©×œ×— ×œ××™××™×™×œ ×©×œ×š",verificationCode:"×§×•×“ ××™××•×ª",verify:"×××ª",returnPolicy:"××“×™× ×™×•×ª ×”×—×–×¨×•×ª",addToCart:"×”×•×¡×£ ×œ×¢×’×œ×”",addedToCart:"×”××•×¦×¨ × ×•×¡×£ ×œ×¢×’×œ×”!",remove:"×”×¡×¨",noProducts:"××™×Ÿ ××•×¦×¨×™× ×œ×”×¦×’×” ×›×¨×’×¢",errorLoading:"×©×’×™××” ×‘×˜×¢×™× ×”",days:"×™××™×",currency:"â‚ª",free:"×—×™× ×",freeAbove:"××©×œ×•×— ×—×™× × ××¢×œ",noShippingMethods:"××™×Ÿ ××¤×©×¨×•×™×•×ª ××©×œ×•×— ×–××™× ×•×ª",viewAllResults:"×”×¦×’ ××ª ×›×œ ×”×ª×•×¦××•×ª",searchProducts:"×—×™×¤×•×© ××•×¦×¨×™×",productDetails:"×¤×¨×˜×™ ×”××•×¦×¨",viewDetails:"×œ×¤×¨×˜×™× × ×•×¡×¤×™×",inStock:"×‘××œ××™",outOfStock:"××–×œ ××”××œ××™",sku:'××§"×˜',category:"×§×˜×’×•×¨×™×”",relatedProducts:"××•×¦×¨×™× ×“×•××™×",productNotFound:"×”××•×¦×¨ ×œ× × ××¦×",backToProducts:"×—×–×¨×” ×œ××•×¦×¨×™×",quantity:"×›××•×ª",couponCode:"×§×•×“ ×§×•×¤×•×Ÿ",enterCouponCode:"×”×–×Ÿ ×§×•×“ ×§×•×¤×•×Ÿ",applyCoupon:"×”×—×œ",removeCoupon:"×”×¡×¨",couponApplied:"×”×§×•×¤×•×Ÿ ×”×•×—×œ ×‘×”×¦×œ×—×”!",invalidCoupon:"×§×•×“ ×§×•×¤×•×Ÿ ×œ× ×ª×§×™×Ÿ",couponExpired:"×”×§×•×¤×•×Ÿ ×¤×’ ×ª×•×§×£",couponMinOrder:"×¡×›×•× ×”×–×× ×” ××™× ×™××œ×™",alreadyHaveAccount:"×›×‘×¨ ×™×© ×œ×š ×—×©×‘×•×Ÿ?",loginHere:"×”×ª×—×‘×¨ ×›××Ÿ",loggedInAs:"××—×•×‘×¨ ×›:",logout:"×”×ª× ×ª×§",haveCouponCode:"×™×© ×œ×™ ×§×•×“ ×§×•×¤×•×Ÿ",orderSuccess:"×”×”×–×× ×” ×”×ª×§×‘×œ×”!",thankYouOrder:"×ª×•×“×” ×¢×œ ×”×”×–×× ×”",orderNumber:"××¡×¤×¨ ×”×–×× ×”",orderConfirmation:"××™×©×•×¨ ×”×–×× ×” × ×©×œ×— ×œ××™××™×™×œ ×©×œ×š",orderProcessing:"×”×”×–×× ×” ×©×œ×š ×‘×˜×™×¤×•×œ. × ×¢×“×›×Ÿ ××•×ª×š ×›×©×”××©×œ×•×— ×™×¦× ×œ×“×¨×š.",continueShopping:"×œ×”××©×š ×§× ×™×•×ª",orderDetails:"×¤×¨×˜×™ ×”×”×–×× ×”",loadingOrder:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×”×–×× ×”...",orderNotFound:"×œ× × ××¦××” ×”×–×× ×”",orderItems:"×¤×¨×™×˜×™× ×‘×”×–×× ×”",paidAmount:"×¡×›×•× ×©×©×•×œ×",myAccount:"×”×—×©×‘×•×Ÿ ×©×œ×™",accountWelcome:"×‘×¨×•×š ×”×‘×",yourOrders:"×”×”×–×× ×•×ª ×©×œ×š",noOrders:"××™×Ÿ ×¢×“×™×™×Ÿ ×”×–×× ×•×ª",orderDate:"×ª××¨×™×š",orderStatus:"×¡×˜×˜×•×¡",orderTotal:'×¡×”"×›',viewOrder:"×¦×¤×” ×‘×”×–×× ×”",statusPending:"×××ª×™×Ÿ ×œ×ª×©×œ×•×",statusPaid:"×©×•×œ×",statusProcessing:"×‘×˜×™×¤×•×œ",statusShipped:"× ×©×œ×—",statusDelivered:"× ××¡×¨",statusCancelled:"×‘×•×˜×œ",notLoggedIn:"×œ× ××—×•×‘×¨",pleaseLogin:"×™×© ×œ×”×ª×—×‘×¨ ×›×“×™ ×œ×¦×¤×•×ª ×‘×—×©×‘×•×Ÿ",selectVariant:"×‘×—×¨ ××¤×©×¨×•×ª",variantUnavailable:"×œ× ×–××™×Ÿ",color:"×¦×‘×¢",size:"××™×“×”",material:"×—×•××¨",style:"×¡×’× ×•×Ÿ",weight:"××©×§×œ",capacity:"×§×™×‘×•×œ×ª",length:"××•×¨×š"};let o=window.location.pathname;const a=new URLSearchParams(window.location.search).get("page");a&&(o=a);const r=o.split("/"),i=r[r.length-1];if(i&&"product"!==i){console.log("Loading product with slug:",i);try{const o=await fetch(buildApiUrl("/api/ecommerce/storefront/products/"+encodeURIComponent(i)+"?websiteId="+t)),a=await o.json();if(!a.success||!a.data)return void showProductNotFound(e,n);const r=a.data;renderProductDetail(e,r,n),document.title=r.name+" - "+(document.title.split(" - ").pop()||""),loadRelatedProducts(r,n)}catch(t){console.error("Failed to load product",t),showProductNotFound(e,n)}}else showProductNotFound(e,n)}function showProductNotFound(e,t){e.innerHTML=`\n    <div class="product-not-found">\n      <h2>${t.productNotFound}</h2>\n      <a href="/products" class="btn btn-primary">${t.backToProducts}</a>\n    </div>\n  `}function renderProductDetail(e,t,n){const o=(t.images||[]).map(function(e){return e?e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/")||e.startsWith("data:")?e:"/"+e:""}),a=o[0]||"",r=o.length>1,i="out_of_stock"!==t.stock_status,c=t.sale_price&&parseFloat(t.sale_price)<parseFloat(t.price),s=c?parseFloat(t.sale_price):parseFloat(t.price),d=parseFloat(t.price),l=t.variants||[],u=l.length>0;let p="";if(u){const e={};l.forEach(t=>{t.attributes&&!1!==t.is_active&&Object.entries(t.attributes).forEach(([t,n])=>{e[t]||(e[t]=new Set),e[t].add(n)})});const t={color:n.color||"Color",size:n.size||"Size",material:n.material||"Material",style:n.style||"Style",weight:n.weight||"Weight",capacity:n.capacity||"Capacity",length:n.length||"Length"};p='<div class="product-variants" id="product-variants">'+Object.entries(e).map(([e,n])=>{const o=t[e.toLowerCase()]||e.charAt(0).toUpperCase()+e.slice(1),a=Array.from(n),r="color"===e.toLowerCase(),i=a.map(t=>{if(r){var n=t;return/^#[0-9A-Fa-f]{3,6}$/.test(t)||(n=t.toLowerCase()),'<button type="button" class="variant-option color-swatch" data-attr="'+e+'" data-value="'+t+'" style="background-color: '+n+';" title="'+t+'"></button>'}return'<button type="button" class="variant-option" data-attr="'+e+'" data-value="'+t+'">'+t+"</button>"}).join("");return'<div class="variant-group" data-group="'+e+'"><label class="variant-group-label">'+o+':</label><div class="variant-options">'+i+"</div></div>"}).join("")+"</div>"}e.innerHTML=`\n    <a href="/products" class="back-to-products">\n      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>\n      ${n.backToProducts}\n    </a>\n    <div class="product-detail-container">\n      <div class="product-gallery">\n        ${a?'<img src="'+a+'" alt="'+t.name+'" class="product-gallery-main" id="product-main-image">':'<div class="product-gallery-main" style="display:flex;align-items:center;justify-content:center;color:#999;font-size:64px;">ğŸ“¦</div>'}\n        ${r?`\n          <div class="product-gallery-thumbs">\n            ${o.map((e,n)=>`\n              <img src="${e}" alt="${t.name}" class="product-gallery-thumb ${0===n?"active":""}" onclick="changeMainImage(this, '${e}')" />\n            `).join("")}\n          </div>\n        `:""}\n      </div>\n      <div class="product-info">\n        <h1>${t.name}</h1>\n        ${t.category_name?'<span class="product-category">'+t.category_name+"</span>":""}\n        <div class="product-price" id="product-price-display">\n          ${c?n.currency+t.sale_price+'<span class="original-price">'+n.currency+t.price+"</span>":n.currency+t.price}\n        </div>\n        ${t.sku?'<div class="product-sku" id="product-sku-display">'+n.sku+": "+t.sku+"</div>":""}\n        <div class="product-stock ${i?"in-stock":"out-of-stock"}" id="product-stock-display">\n          ${i?'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>'+n.inStock:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>'+n.outOfStock}\n        </div>\n        ${t.description?'<div class="product-description">'+t.description+"</div>":""}\n        ${p}\n        <div class="product-quantity">\n          <label>${n.quantity}:</label>\n          <div class="quantity-selector">\n            <button type="button" onclick="adjustQuantity(-1)">âˆ’</button>\n            <input type="number" id="product-quantity" value="1" min="1" max="99">\n            <button type="button" onclick="adjustQuantity(1)">+</button>\n          </div>\n        </div>\n        <div class="product-actions">\n          <button class="add-to-cart" id="add-to-cart-btn" onclick="addProductToCart()" ${i?"":'disabled style="opacity:0.5;cursor:not-allowed;"'}>\n            ${n.addToCart}\n          </button>\n        </div>\n      </div>\n    </div>\n  `,window.currentProduct=t,window.selectedVariant=null,window.productBasePrice=s,window.productOriginalPrice=d,window.productHasSalePrice=c,window.productTranslations=n,u&&initVariantSelection(t,n)}function changeMainImage(e,t){const n=document.getElementById("product-main-image");n&&(n.src=t),document.querySelectorAll(".product-gallery-thumb").forEach(e=>e.classList.remove("active")),e.classList.add("active")}function adjustQuantity(e){const t=document.getElementById("product-quantity");if(!t)return;const n=Math.max(1,Math.min(99,parseInt(t.value||1)+e));t.value=n}function initVariantSelection(e,t){const n=e.variants||[];let o={};const a=document.querySelectorAll(".variant-option");function r(e){if(!e||!o[e])return void a.forEach(e=>{e.classList.remove("disabled"),e.disabled=!1});const t=o[e];a.forEach(o=>{const a=o.getAttribute("data-attr"),r=o.getAttribute("data-value");if(a===e)return o.classList.remove("disabled"),void(o.disabled=!1);const i=function(e,t,o,a){return n.some(n=>!(!n.attributes||!1===n.is_active)&&n.attributes[e]===t&&n.attributes[o]===a)}(a,r,e,t);i?(o.classList.remove("disabled"),o.disabled=!1):(o.classList.add("disabled"),o.disabled=!0)})}a.forEach(i=>{i.addEventListener("click",function(){const i=this.getAttribute("data-attr"),c=this.getAttribute("data-value");if(this.disabled||this.classList.contains("disabled")){const e=function(){const e=new Set;return a.forEach(t=>e.add(t.getAttribute("data-attr"))),Array.from(e)}();e.forEach(e=>{e!==i&&(delete o[e],document.querySelectorAll('.variant-option[data-attr="'+e+'"]').forEach(e=>{e.classList.remove("selected")}))})}document.querySelectorAll('.variant-option[data-attr="'+i+'"]').forEach(e=>e.classList.remove("selected")),this.classList.add("selected"),o[i]=c,r(i);updateVariantUI(findMatchingVariant(n,o),e,t,o)})})}function findMatchingVariant(e,t){const n=Object.keys(t);return 0===n.length?null:e.find(e=>!(!e.attributes||!1===e.is_active)&&n.every(n=>e.attributes[n]===t[n]))}function updateVariantUI(e,t,n,o){const a=document.getElementById("product-price-display"),r=document.getElementById("product-stock-display"),i=document.getElementById("product-sku-display"),c=document.getElementById("add-to-cart-btn"),s=window.productBasePrice,d=window.productOriginalPrice,l=window.productHasSalePrice;if(e){const t=parseFloat(e.price_modifier||0),o=s+t,u=l?d+t:null;a&&(l&&u?a.innerHTML=n.currency+o.toFixed(2)+'<span class="original-price">'+n.currency+u.toFixed(2)+"</span>":a.textContent=n.currency+o.toFixed(2));const p="out_of_stock"!==e.stock_status;r&&(r.className="product-stock "+(p?"in-stock":"out-of-stock"),r.innerHTML=p?'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>'+n.inStock:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>'+n.outOfStock),i&&e.sku&&(i.textContent=n.sku+": "+e.sku),c&&(c.disabled=!p,c.style.opacity=p?"1":"0.5",c.style.cursor=p?"pointer":"not-allowed"),window.selectedVariant=e}else{a&&(l?a.innerHTML=n.currency+s.toFixed(2)+'<span class="original-price">'+n.currency+d.toFixed(2)+"</span>":a.textContent=n.currency+s.toFixed(2));const e="out_of_stock"!==t.stock_status;r&&(r.className="product-stock "+(e?"in-stock":"out-of-stock"),r.innerHTML=e?'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>'+n.inStock:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>'+n.outOfStock),c&&(c.disabled=!e,c.style.opacity=e?"1":"0.5",c.style.cursor=e?"pointer":"not-allowed"),window.selectedVariant=null}}function addProductToCart(){const e=window.currentProduct;if(!e)return;const t=parseInt(document.getElementById("product-quantity")?.value||1),n=window.selectedVariant,o={...e,quantity:t};if(n){const e=window.productBasePrice,t=parseFloat(n.price_modifier||0),a=e+t;o.selectedVariant={id:n.id,name:n.name,sku:n.sku,attributes:n.attributes,priceModifier:t},o.variantName=n.name,o.displayPrice=a,window.productHasSalePrice?o.sale_price=a.toString():o.price=a.toString(),n.sku&&(o.variantSku=n.sku)}for(let e=0;e<t;e++)window.zappyAddToCart(o)}async function loadRelatedProducts(e,t){const n=document.getElementById("related-products-section"),o=document.getElementById("related-products-grid");if(!n||!o)return;const a=window.ZAPPY_WEBSITE_ID;try{let r=buildApiUrl("/api/ecommerce/storefront/products?websiteId="+a+"&limit=4");e.category_id&&(r+="&categoryId="+e.category_id);const i=await fetch(r),c=await i.json();if(!c.success||!c.data?.length)return;const s=c.data.filter(t=>t.id!==e.id).slice(0,4);if(0===s.length)return;renderProductGrid(o,s,t),n.style.display="block"}catch(e){console.error("Failed to load related products",e)}}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("mobileToggle"),t=document.getElementById("navMenu");if(e){e.addEventListener("click",function(){const e=this.querySelector(".hamburger-icon"),n=this.querySelector(".close-icon");this.classList.contains("active")?(e.style.display="block",n.style.display="none",this.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow=""):(e.style.display="none",n.style.display="block",this.classList.add("active"),t.classList.add("active"),document.body.style.overflow="hidden")});t.querySelectorAll("a").forEach(n=>{n.addEventListener("click",function(){const n=e.querySelector(".hamburger-icon"),o=e.querySelector(".close-icon");n.style.display="block",o.style.display="none",e.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow=""})})}const n=document.querySelector(".phone-header-btn");n&&n.addEventListener("click",function(){window.location.href="tel:[business_phone]"});const o=document.getElementById("contactForm");o&&o.addEventListener("submit",function(e){e.preventDefault();const t=new FormData(o),n={};t.forEach((e,t)=>{n[t]=e}),console.log("Form submitted:",n),alert("×ª×•×“×” ×¢×œ ×¤× ×™×™×ª×š! × ×™×¦×•×¨ ××™×ª×š ×§×©×¨ ×‘×”×§×“×."),o.reset()})}),function(){"use strict";let e=0;function t(){if(e++,void 0===window.CookieConsent)return void(e<50&&setTimeout(t,100));const n=window.CookieConsent;try{n.run({autoShow:!0,mode:"opt-in",revision:0,categories:{necessary:{enabled:!0,readOnly:!0},analytics:{enabled:!1,readOnly:!1,autoClear:{cookies:[{name:"_ga"},{name:"_ga_*"},{name:"_gid"},{name:"_gat"}]}},marketing:{enabled:!1,readOnly:!1,autoClear:{cookies:[{name:"_fbp"},{name:"_fbc"},{name:"fr"}]}}},language:{default:"he",translations:{he:{consentModal:{title:"×× ×—× ×• ××©×ª××©×™× ×‘×¢×•×’×™×•×ª ğŸª",description:"×—×œ×•××•×ª ××ª×•×§×™× ××©×ª××© ×‘×¢×•×’×™×•×ª ×›×“×™ ×œ×©×¤×¨ ××ª ×”×—×•×•×™×” ×©×œ×š, ×œ× ×ª×— ×©×™××•×© ×‘××ª×¨ ×•×œ×¡×™×™×¢ ×‘××××¦×™ ×”×©×™×•×•×§ ×©×œ× ×•.",acceptAllBtn:"××©×¨ ×”×›×œ",acceptNecessaryBtn:"×¨×§ ×”×›×¨×—×™",showPreferencesBtn:"× ×”×œ ×”×¢×“×¤×•×ª",footer:'<a href="#privacy-policy">××“×™× ×™×•×ª ×¤×¨×˜×™×•×ª</a> | <a href="#terms-conditions">×ª× ××™ ×©×™××•×©</a>'},preferencesModal:{title:"×”×¢×“×¤×•×ª ×¢×•×’×™×•×ª",acceptAllBtn:"××©×¨ ×”×›×œ",acceptNecessaryBtn:"×¨×§ ×”×›×¨×—×™",savePreferencesBtn:"×©××•×¨ ×”×¢×“×¤×•×ª",closeIconLabel:"×¡×’×•×¨",sections:[{title:"×¢×•×’×™×•×ª ×—×™×•× ×™×•×ª",description:"×¢×•×’×™×•×ª ××œ×” ×”×›×¨×—×™×•×ª ×œ×ª×¤×§×•×“ ×”××ª×¨ ×•×œ× × ×™×ª×Ÿ ×œ×”×©×‘×™×ª ××•×ª×Ÿ.",linkedCategory:"necessary"},{title:"×¢×•×’×™×•×ª × ×™×ª×•×—",description:"×¢×•×’×™×•×ª ××œ×” ×¢×•×–×¨×•×ª ×œ× ×• ×œ×”×‘×™×Ÿ ××™×š ×”××‘×§×¨×™× ××ª×§×©×¨×™× ×¢× ×”××ª×¨ ×©×œ× ×•.",linkedCategory:"analytics"},{title:"×¢×•×’×™×•×ª ×©×™×•×•×§×™×•×ª",description:"×¢×•×’×™×•×ª ××œ×” ××©××©×•×ª ×œ×”×¦×’×ª ×¤×¨×¡×•××•×ª ××•×ª×××•×ª ××™×©×™×ª.",linkedCategory:"marketing"}]}}}},guiOptions:{consentModal:{layout:"box",position:"bottom right",equalWeightButtons:!0,flipButtons:!1},preferencesModal:{layout:"box",equalWeightButtons:!0,flipButtons:!1}}}),"function"==typeof n.onChange&&n.onChange(function(e,t){t.includes("analytics")&&n.validConsent("analytics"),t.includes("marketing")&&n.validConsent("marketing")})}catch(e){}}"loading"===document.readyState?(document.addEventListener("DOMContentLoaded",t),setTimeout(t,1e3)):"interactive"===document.readyState||"complete"===document.readyState?t():setTimeout(t,500),"undefined"!=typeof window&&window.addEventListener&&window.addEventListener("load",t,{once:!0})}(),window.onload=function(){try{window.micAccessTool=new MicAccessTool({buttonPosition:"left",forceLang:"he-IL",icon:{position:{bottom:{size:50,units:"px"},left:{size:20,units:"px"},type:"fixed"},backgroundColor:"transparent",color:"transparent",img:"accessible",circular:!1},menu:{dimensions:{width:{size:300,units:"px"},height:{size:"auto",units:"px"}}}})}catch(e){}document.addEventListener("keydown",function(e){var t=e.altKey||e.metaKey,n=65===e.keyCode||65===e.which||e.key&&("a"===e.key.toLowerCase()||"Ã¥"===e.key||"Ã…"===e.key);t&&n&&(window.innerWidth>768&&(e.preventDefault(),e.stopPropagation(),document.body.classList.contains("accessibility-widget-visible")?document.body.classList.remove("accessibility-widget-visible"):(document.body.classList.add("accessibility-widget-visible"),setTimeout(function(){var e=document.getElementById("mic-access-tool-general-button");e&&e.click()},200))))},!0)},function(){function e(){console.log("ğŸ“§ Zappy: Initializing contact form API integration...");const e=document.querySelector(".contact-form")||document.querySelector('form[action*="contact"]')||document.querySelector("form#contact")||document.querySelector("form#contactForm")||document.getElementById("contactForm")||document.querySelector("section.contact form")||document.querySelector("section#contact form")||document.querySelector("form");if(!e)return void console.log("âš ï¸ Zappy: No contact form found on page");console.log("âœ… Zappy: Contact form found:",e.className||e.id||"unnamed form");e.onsubmit;e.addEventListener("submit",async function(e){const t=new FormData(this),n=Object.fromEntries(t);try{console.log("ğŸ“§ Zappy: Sending contact form to backend API...");const e=await fetch("https://qaapi.zappy5.com/api/email/contact-form",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteId:"a14f878e-a00f-4437-96f4-7eca17fa02d5",name:n.name||"",email:n.email||"",subject:n.subject||"Contact Form Submission",message:n.message||"",phone:n.phone||null})}),t=await e.json();t.success?console.log("âœ… Zappy: Contact form data sent successfully to backend"):console.log("âš ï¸ Zappy: Backend returned error:",t.error)}catch(e){console.error("âŒ Zappy: Failed to send to backend API:",e)}},!0),console.log("âœ… Zappy: Contact form API integration initialized")}window.zappyContactFormLoaded?console.log("ğŸ“§ Zappy contact form already loaded"):(window.zappyContactFormLoaded=!0,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e())}(),function(){const e=window.ZAPPY_WEBSITE_ID,t=function(e){"/"!==e.charAt(0)&&(e="/"+e);const t=function(){const e=(window.ZAPPY_API_BASE||"").replace(/\/$/,""),t=window.location?window.location.pathname:"";return-1!==t.indexOf("/preview")||-1!==t.indexOf("/preview-fullscreen")?window.location.origin:e}();return t?t+e:e};if(!e)return;const n={products:"××•×¦×¨×™×",ourProducts:"×”××•×¦×¨×™× ×©×œ× ×•",featuredProducts:"××•×¦×¨×™× ××•××œ×¦×™×",noFeaturedProducts:"×¢×•×“ ×œ× × ×‘×—×¨×• ××•×¦×¨×™× ××•××œ×¦×™×. ×¦×¤×• ×‘×›×œ ×”××•×¦×¨×™× ×©×œ× ×•!",featuredCategories:"×§× ×• ×œ×¤×™ ×§×˜×’×•×¨×™×”",all:"×”×›×œ",featured:"××•××œ×¦×™×",new:"×—×“×©×™×",sale:"××‘×¦×¢×™×",loadingProducts:"×˜×•×¢×Ÿ ××•×¦×¨×™×...",cart:"×¢×’×œ×ª ×§× ×™×•×ª",yourCart:"×¢×’×œ×ª ×”×§× ×™×•×ª ×©×œ×š",emptyCart:"×”×¢×’×œ×” ×¨×™×§×”",total:'×¡×”"×›',proceedToCheckout:"×”××©×š ×œ×ª×©×œ×•×",checkout:"×ª×©×œ×•×",customerInfo:"×¤×¨×˜×™ ×œ×§×•×—",fullName:"×©× ××œ×",email:"××™××™×™×œ",phone:"×˜×œ×¤×•×Ÿ",shippingAddress:"×›×ª×•×‘×ª ×œ××©×œ×•×—",street:"×¨×—×•×‘ ×•××¡×¤×¨",apartment:"×“×™×¨×”, ×§×•××”, ×›× ×™×¡×”",city:"×¢×™×¨",zip:"××™×§×•×“",shippingMethod:"×©×™×˜×ª ××©×œ×•×—",loadingShipping:"×˜×•×¢×Ÿ ×©×™×˜×•×ª ××©×œ×•×—...",payment:"×ª×©×œ×•×",loadingPayment:"×˜×•×¢×Ÿ ××¤×©×¨×•×™×•×ª ×ª×©×œ×•×...",orderSummary:"×¡×™×›×•× ×”×–×× ×”",subtotal:"×¡×›×•× ×‘×™× ×™×™×",vat:'××¢"×',vatIncluded:'×›×•×œ×œ ××¢"×',shipping:"××©×œ×•×—",discount:"×”× ×—×”",totalToPay:'×¡×”"×› ×œ×ª×©×œ×•×',placeOrder:"×‘×¦×¢ ×”×–×× ×”",login:"×”×ª×—×‘×¨×•×ª",customerLogin:"×”×ª×—×‘×¨×•×ª ×œ×§×•×—×•×ª",enterEmail:"×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”××™××™×™×œ ×©×œ×š ×•× ×©×œ×— ×œ×š ×§×•×“ ×”×ª×—×‘×¨×•×ª",emailAddress:"×›×ª×•×‘×ª ××™××™×™×œ",sendCode:"×©×œ×— ×§×•×“",enterCode:"×”×–×Ÿ ××ª ×”×§×•×“ ×©× ×©×œ×— ×œ××™××™×™×œ ×©×œ×š",verificationCode:"×§×•×“ ××™××•×ª",verify:"×××ª",returnPolicy:"××“×™× ×™×•×ª ×”×—×–×¨×•×ª",addToCart:"×”×•×¡×£ ×œ×¢×’×œ×”",addedToCart:"×”××•×¦×¨ × ×•×¡×£ ×œ×¢×’×œ×”!",remove:"×”×¡×¨",noProducts:"××™×Ÿ ××•×¦×¨×™× ×œ×”×¦×’×” ×›×¨×’×¢",errorLoading:"×©×’×™××” ×‘×˜×¢×™× ×”",days:"×™××™×",currency:"â‚ª",free:"×—×™× ×",freeAbove:"××©×œ×•×— ×—×™× × ××¢×œ",noShippingMethods:"××™×Ÿ ××¤×©×¨×•×™×•×ª ××©×œ×•×— ×–××™× ×•×ª",viewAllResults:"×”×¦×’ ××ª ×›×œ ×”×ª×•×¦××•×ª",searchProducts:"×—×™×¤×•×© ××•×¦×¨×™×",productDetails:"×¤×¨×˜×™ ×”××•×¦×¨",viewDetails:"×œ×¤×¨×˜×™× × ×•×¡×¤×™×",inStock:"×‘××œ××™",outOfStock:"××–×œ ××”××œ××™",sku:'××§"×˜',category:"×§×˜×’×•×¨×™×”",relatedProducts:"××•×¦×¨×™× ×“×•××™×",productNotFound:"×”××•×¦×¨ ×œ× × ××¦×",backToProducts:"×—×–×¨×” ×œ××•×¦×¨×™×",quantity:"×›××•×ª",couponCode:"×§×•×“ ×§×•×¤×•×Ÿ",enterCouponCode:"×”×–×Ÿ ×§×•×“ ×§×•×¤×•×Ÿ",applyCoupon:"×”×—×œ",removeCoupon:"×”×¡×¨",couponApplied:"×”×§×•×¤×•×Ÿ ×”×•×—×œ ×‘×”×¦×œ×—×”!",invalidCoupon:"×§×•×“ ×§×•×¤×•×Ÿ ×œ× ×ª×§×™×Ÿ",couponExpired:"×”×§×•×¤×•×Ÿ ×¤×’ ×ª×•×§×£",couponMinOrder:"×¡×›×•× ×”×–×× ×” ××™× ×™××œ×™",alreadyHaveAccount:"×›×‘×¨ ×™×© ×œ×š ×—×©×‘×•×Ÿ?",loginHere:"×”×ª×—×‘×¨ ×›××Ÿ",loggedInAs:"××—×•×‘×¨ ×›:",logout:"×”×ª× ×ª×§",haveCouponCode:"×™×© ×œ×™ ×§×•×“ ×§×•×¤×•×Ÿ",orderSuccess:"×”×”×–×× ×” ×”×ª×§×‘×œ×”!",thankYouOrder:"×ª×•×“×” ×¢×œ ×”×”×–×× ×”",orderNumber:"××¡×¤×¨ ×”×–×× ×”",orderConfirmation:"××™×©×•×¨ ×”×–×× ×” × ×©×œ×— ×œ××™××™×™×œ ×©×œ×š",orderProcessing:"×”×”×–×× ×” ×©×œ×š ×‘×˜×™×¤×•×œ. × ×¢×“×›×Ÿ ××•×ª×š ×›×©×”××©×œ×•×— ×™×¦× ×œ×“×¨×š.",continueShopping:"×œ×”××©×š ×§× ×™×•×ª",orderDetails:"×¤×¨×˜×™ ×”×”×–×× ×”",loadingOrder:"×˜×•×¢×Ÿ ×¤×¨×˜×™ ×”×–×× ×”...",orderNotFound:"×œ× × ××¦××” ×”×–×× ×”",orderItems:"×¤×¨×™×˜×™× ×‘×”×–×× ×”",paidAmount:"×¡×›×•× ×©×©×•×œ×",myAccount:"×”×—×©×‘×•×Ÿ ×©×œ×™",accountWelcome:"×‘×¨×•×š ×”×‘×",yourOrders:"×”×”×–×× ×•×ª ×©×œ×š",noOrders:"××™×Ÿ ×¢×“×™×™×Ÿ ×”×–×× ×•×ª",orderDate:"×ª××¨×™×š",orderStatus:"×¡×˜×˜×•×¡",orderTotal:'×¡×”"×›',viewOrder:"×¦×¤×” ×‘×”×–×× ×”",statusPending:"×××ª×™×Ÿ ×œ×ª×©×œ×•×",statusPaid:"×©×•×œ×",statusProcessing:"×‘×˜×™×¤×•×œ",statusShipped:"× ×©×œ×—",statusDelivered:"× ××¡×¨",statusCancelled:"×‘×•×˜×œ",notLoggedIn:"×œ× ××—×•×‘×¨",pleaseLogin:"×™×© ×œ×”×ª×—×‘×¨ ×›×“×™ ×œ×¦×¤×•×ª ×‘×—×©×‘×•×Ÿ",selectVariant:"×‘×—×¨ ××¤×©×¨×•×ª",variantUnavailable:"×œ× ×–××™×Ÿ",color:"×¦×‘×¢",size:"××™×“×”",material:"×—×•××¨",style:"×¡×’× ×•×Ÿ",weight:"××©×§×œ",capacity:"×§×™×‘×•×œ×ª",length:"××•×¨×š"},o="â‚ª"===n.currency||"rtl"===document.documentElement.dir||"rtl"===document.body.dir;let a=JSON.parse(localStorage.getItem("zappy_cart_"+e)||"[]"),r=.18,i=!1;function c(e){return(e||"").replace(/[â€â€â€ª-â€®â¦-â©â€‹-â€ï»¿]/g,"").trim()}function s(){localStorage.setItem("zappy_cart_"+e,JSON.stringify(a)),d(),g()}function d(){const e=a.reduce((e,t)=>e+t.quantity,0);document.querySelectorAll(".cart-count").forEach(function(t){t.textContent=e})}function l(e){return e.sale_price&&parseFloat(e.sale_price)<parseFloat(e.price)?parseFloat(e.sale_price):parseFloat(e.price)}function u(e){const t=e.selectedVariant?e.selectedVariant.id:null,n=t?e.id+"-"+t:e.id,o=a.find(e=>{const t=e.selectedVariant?e.selectedVariant.id:null;return(t?e.id+"-"+t:e.id)===n});o?o.quantity++:a.push({...e,quantity:1}),s(),f()}!async function(){if(!i)try{const n=await fetch(t("/api/ecommerce/storefront/settings?websiteId="+e)),o=await n.json();o.success&&o.data&&(o.data.taxRate&&o.data.taxRate>0&&(r=o.data.taxRate),i=!0)}catch(e){console.warn("Failed to fetch store settings, using default VAT rate:",e)}}();var p=[],m="all";async function y(o){const a=document.getElementById("zappy-product-grid");if(a){m=o||"all",document.querySelectorAll(".filter-btn").forEach(function(e){e.classList.remove("active"),e.getAttribute("data-category")===m&&e.classList.add("active")});try{const o=new URLSearchParams(window.location.search),c=o.get("page");let s=o.get("category");if(c){s=new URL(c,window.location.origin).searchParams.get("category")||s}let d=t("/api/ecommerce/storefront/products?websiteId="+e);s&&(d+="&categoryId="+s);const l=await fetch(d),u=await l.json();if(!u.success||!u.data?.length)return a.innerHTML='<div class="empty-cart">'+n.noProducts+"</div>",void(p=[]);var r=p=u.data;if("featured"===m)r=p.filter(function(e){return e.is_featured});else if("sale"===m)r=p.filter(function(e){return e.sale_price&&parseFloat(e.sale_price)<parseFloat(e.price)});else if("new"===m){var i=new Date;i.setDate(i.getDate()-30),r=p.filter(function(e){var t=e.tags&&e.tags.some(function(e){return"new"===e.toLowerCase()||"×—×“×©"===e.toLowerCase()}),n=e.created_at&&new Date(e.created_at)>i;return t||n})}if(0===r.length)return void(a.innerHTML='<div class="empty-cart">'+n.noProducts+"</div>");!function(e,t){e.innerHTML=t.map(function(e){var t=e.sale_price&&parseFloat(e.sale_price)<parseFloat(e.price),o=t?n.currency+parseFloat(e.sale_price).toFixed(2)+'<span class="original-price">'+n.currency+parseFloat(e.price).toFixed(2)+"</span>":n.currency+parseFloat(e.price).toFixed(2),a=e.images&&e.images[0]?function(e){if(!e)return"";if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/")||e.startsWith("data:"))return e;return"/"+e}(e.images[0]):"",r=[];t&&r.push('<span class="product-tag tag-sale">'+n.sale+"</span>");var i=new Date;i.setDate(i.getDate()-30),(e.tags&&e.tags.some(function(e){return"new"===e.toLowerCase()||"×—×“×©"===e.toLowerCase()})||e.created_at&&new Date(e.created_at)>i)&&r.push('<span class="product-tag tag-new">'+n.new+"</span>"),e.is_featured&&r.push('<span class="product-tag tag-featured">'+n.featured+"</span>"),e.tags&&e.tags.length&&e.tags.forEach(function(e){var t=e.toLowerCase();"new"!==t&&"×—×“×©"!==t&&r.push('<span class="product-tag">'+e+"</span>")});var c=r.length>0?'<div class="product-tags">'+r.join("")+"</div>":"";return'<div class="product-card" data-product-id="'+e.id+'">'+c+'<a href="/product/'+(e.slug||e.id)+'" class="product-card-link">'+(a?'<img src="'+a+'" alt="'+e.name+'">':'<div style="height:200px;background:#f0f0f0;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#999;">ğŸ“¦</div>')+"<h3>"+e.name+"</h3><p>"+(e.description||"").substring(0,100)+'</p><div class="price">'+o+'</div></a><button class="add-to-cart" onclick="event.stopPropagation(); window.zappyHandleAddToCart('+JSON.stringify(e).replace(/"/g,"&quot;")+')">'+n.addToCart+"</button></div>"}).join("")}(a,r)}catch(e){console.error("Failed to load products",e),a.innerHTML='<div class="empty-cart">'+n.errorLoading+"</div>"}}}function g(){const e=document.getElementById("cart-drawer-items"),t=document.getElementById("cart-drawer-total");if(!e)return;if(0===a.length)return e.innerHTML='<div class="empty-cart"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg><p>'+n.emptyCart+"</p></div>",void(t&&(t.textContent=n.currency+"0"));let o=0;e.innerHTML=a.map(e=>{const t=l(e);o+=t*e.quantity;const a=e.variantName?'<div class="cart-item-variant">'+e.variantName+"</div>":"";return'<div class="cart-item" data-item-id="'+e.id+(e.selectedVariant?"-"+e.selectedVariant.id:"")+'"><img src="'+(e.images?.[0]||"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2270%22 height=%2270%22 viewBox=%220 0 70 70%22%3E%3Crect fill=%22%23f3f4f6%22 width=%2270%22 height=%2270%22/%3E%3Cpath fill=%22%239ca3af%22 d=%22M28 25h14v14H28z%22/%3E%3C/svg%3E")+'" alt="'+e.name+'"><div class="cart-item-info"><div class="cart-item-name">'+e.name+"</div>"+a+'<div class="cart-item-price">'+n.currency+(t*e.quantity).toFixed(2)+'</div><div class="cart-item-qty"><button onclick="window.zappyUpdateQty(\''+e.id+(e.selectedVariant?"-"+e.selectedVariant.id:"")+"', -1)\">âˆ’</button><span>"+e.quantity+"</span><button onclick=\"window.zappyUpdateQty('"+e.id+(e.selectedVariant?"-"+e.selectedVariant.id:"")+'\', 1)">+</button></div></div><button class="cart-item-remove" onclick="window.zappyRemoveFromCart(\''+e.id+(e.selectedVariant?"-"+e.selectedVariant.id:"")+'\')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg></button></div>'}).join(""),t&&(t.textContent=n.currency+o.toFixed(2))}function f(){var e=document.getElementById("cart-drawer"),t=document.getElementById("cart-drawer-overlay");if(!e){var o='<div class="cart-drawer-overlay" id="cart-drawer-overlay"></div><aside class="cart-drawer" id="cart-drawer"><div class="cart-drawer-header"><h2>'+n.yourCart+'</h2><button type="button" class="cart-drawer-close" id="cart-drawer-close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></button></div><div class="cart-drawer-body" id="cart-drawer-items"><div class="empty-cart">'+n.emptyCart+'</div></div><div class="cart-drawer-footer"><div class="cart-drawer-total"><span>'+n.total+':</span><span id="cart-drawer-total">'+n.currency+'0</span></div><a href="/checkout" class="cart-drawer-checkout">'+n.proceedToCheckout+"</a></div></aside>";document.body.insertAdjacentHTML("beforeend",o),e=document.getElementById("cart-drawer"),t=document.getElementById("cart-drawer-overlay");var a=document.getElementById("cart-drawer-close");a&&a.addEventListener("click",v),t&&t.addEventListener("click",v)}e&&(e.classList.add("active"),document.body.style.overflow="hidden"),t&&t.classList.add("active"),g()}function v(){var e=document.getElementById("cart-drawer"),t=document.getElementById("cart-drawer-overlay");e&&e.classList.remove("active"),t&&t.classList.remove("active"),document.body.style.overflow=""}function h(){const e=document.getElementById("cart-items"),t=document.getElementById("cart-total");if(!e)return;if(0===a.length)return e.innerHTML='<div class="empty-cart">'+n.emptyCart+"</div>",void(t&&(t.textContent=n.currency+"0"));let o=0;e.innerHTML=a.map(e=>{const t=l(e);o+=t*e.quantity;const a=e.variantName?'<br><span style="font-size:12px;color:#6b7280;">'+e.variantName+"</span>":"",r=e.selectedVariant?e.id+"-"+e.selectedVariant.id:e.id;return'<div class="cart-item"><img src="'+(e.images?.[0]||"")+'" alt="'+e.name+'"><div><strong>'+e.name+"</strong>"+a+"<br>"+n.currency+t.toFixed(2)+" x "+e.quantity+"</div><button onclick=\"window.zappyRemoveFromCart('"+r+"')\">"+n.remove+"</button></div>"}).join(""),t&&(t.textContent=n.currency+o.toFixed(2))}window.zappyUpdateQty=function(e,t){const n=a.find(t=>{const n=t.selectedVariant?t.selectedVariant.id:null;return(n?t.id+"-"+n:t.id)===e});n&&(n.quantity+=t,n.quantity<=0&&(a=a.filter(t=>{const n=t.selectedVariant?t.selectedVariant.id:null;return(n?t.id+"-"+n:t.id)!==e})),s(),g())};let w=null,b=[];let k=null,E=[],C=!1;function I(){const r=document.getElementById("place-order-btn");r&&(r.addEventListener("click",async function(i){if(i.preventDefault(),!a||0===a.length)return void alert(o?"×”×¢×’×œ×” ×¨×™×§×”":"Cart is empty");if(!w)return void alert(o?"× × ×œ×‘×—×•×¨ ×©×™×˜×ª ××©×œ×•×—":"Please select a shipping method");if(!C||!k)return void alert(o?"×ª×©×œ×•× ××§×•×•×Ÿ ×œ× ××•×’×“×¨. ×¦×¨×• ×§×©×¨ ×¢× ×‘×¢×œ ×”××ª×¨.":"Online payment not configured. Please contact the store owner.");const s=document.getElementById("customer-name")?.value?.trim()||"",d=c(document.getElementById("customer-email")?.value||""),l=document.getElementById("customer-phone")?.value?.trim()||"";if(!s||!d)return void alert(o?"× × ×œ××œ× ×©× ×•××™××™×™×œ":"Please fill in name and email");const u=document.getElementById("shipping-street")?.value?.trim()||"",p=document.getElementById("shipping-apartment")?.value?.trim()||"",m=document.getElementById("shipping-city")?.value?.trim()||"",y=document.getElementById("shipping-zip")?.value?.trim()||"";if(w.is_pickup||u&&m){r.disabled=!0,r.innerHTML=o?"××¢×‘×“...":"Processing...";try{let n=localStorage.getItem("zappy_session_id");n||(n="sess_"+Math.random().toString(36).substr(2,9)+"_"+Date.now(),localStorage.setItem("zappy_session_id",n));const r=await fetch(t("/api/ecommerce/checkout/init"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteId:e,sessionId:n,customerEmail:d,customerName:s,customerPhone:l,shippingAddress:{street:u,apartment:p,city:m,zip:y},shippingMethodId:w.id,shippingCost:w.price||0,shippingMethodName:w.name||"××©×œ×•×—",cart:a,couponCode:L?L.code:null,couponDiscount:S})}),i=await r.json();if(!i.success||!i.data?.checkoutUrl)throw new Error(i.error||"Checkout initialization failed");const c=i.data.reference;if(c){const e=P(),t=parseFloat(w.price)||0,n=parseFloat(S)||0,o={cartItems:a,subtotal:e,shippingCost:t,discount:n,total:e+t-n,shippingMethodName:w.name||"",customerName:s,customerEmail:d};localStorage.setItem("zappy_pending_order_"+c,JSON.stringify(o))}if("greeninvoice"===i.data.provider){const e=document.getElementById("checkout-payment-section"),t=document.getElementById("greeninvoice-iframe-container"),n=document.getElementById("greeninvoice-iframe");if(e&&t&&n)return e.classList.add("fade-out"),t.style.display="block",t.querySelector(".greeninvoice-iframe-wrapper").innerHTML='<div class="greeninvoice-loading"><div class="greeninvoice-loading-spinner"></div><span>'+(o?"×˜×•×¢×Ÿ ×¢××•×“ ×ª×©×œ×•×...":"Loading payment page...")+"</span></div>",window.addEventListener("message",function(e){e.data&&"zappy_order_success"===e.data.type&&e.data.url&&(window.location.href=e.data.url)}),void setTimeout(function(){e.style.display="none",t.querySelector(".greeninvoice-iframe-wrapper").innerHTML='<iframe id="greeninvoice-iframe" src="'+i.data.checkoutUrl+'" frameborder="0" allowpaymentrequest="true" style="width: 100%; height: 600px; border: none;"></iframe>'},300)}window.location.href=i.data.checkoutUrl}catch(e){console.error("Checkout failed:",e),alert(o?"×©×’×™××” ×‘×ª×”×œ×™×š ×”×ª×©×œ×•×. × ×¡×• ×©×•×‘.":"Checkout failed. Please try again."),r.disabled=!1,r.innerHTML=n.placeOrder||(o?"×‘×¦×¢ ×”×–×× ×”":"Place Order")}}else alert(o?"× × ×œ××œ× ×›×ª×•×‘×ª ×œ××©×œ×•×—":"Please fill in shipping address")}),function(){const e=document.getElementById("customer-name"),n=document.getElementById("customer-email"),o=document.getElementById("customer-phone");if(!e||!n)return;const a=localStorage.getItem("zappy_customer_token"),r=localStorage.getItem("zappy_customer_email"),i=document.getElementById("checkout-login-prompt"),c=document.getElementById("checkout-login-link"),s=document.getElementById("checkout-logged-in"),d=document.getElementById("checkout-logged-in-name"),l=document.getElementById("checkout-logged-in-email"),u=document.getElementById("checkout-logout-btn");c&&c.addEventListener("click",function(){sessionStorage.setItem("zappy_login_return","/checkout")});const p=(e,t)=>{i&&(i.style.display="none"),s&&(s.style.display="flex"),d&&(d.textContent=e||""),l&&(l.textContent=t?"("+t+")":"")},m=()=>{s&&(s.style.display="none"),i&&(i.style.display="flex"),d&&(d.textContent=""),l&&(l.textContent="")};r&&!n.value&&(n.value=r);if(!a)return void m();fetch(t("/api/ecommerce/customers/me"),{headers:{Authorization:"Bearer "+a}}).then(function(e){if(!e.ok)throw new Error("Unauthorized");return e.json()}).then(function(t){if(!t.success||!t.data)throw new Error("Invalid response");const a=t.data,i=a.name||a.email||r||"";p(i,a.email||r||""),a.name&&!e.value&&(e.value=a.name),a.email&&!n.value&&(n.value=a.email),a.phone&&o&&!o.value&&(o.value=a.phone)}).catch(function(){localStorage.removeItem("zappy_customer_token"),localStorage.removeItem("zappy_customer_email"),m()}),u&&u.addEventListener("click",function(){localStorage.removeItem("zappy_customer_token"),localStorage.removeItem("zappy_customer_email"),m()})}())}window.zappySelectPayment=function(e){k=E.find(t=>t.id===e),document.querySelectorAll(".payment-option").forEach(t=>{t.classList.toggle("selected",t.dataset.methodId===e)})};let L=null,S=0;function P(){return a.reduce((e,t)=>e+l(t)*t.quantity,0)}function B(){const e=document.getElementById("subtotal"),t=document.getElementById("vat-amount"),o=document.getElementById("shipping-cost"),i=document.getElementById("discount"),c=document.getElementById("discount-row"),s=document.getElementById("order-total"),d=document.getElementById("order-items"),u=P();let p=function(){if(!w)return 0;const e=P();return w.conditions?.freeAbove&&e>=w.conditions.freeAbove?0:parseFloat(w.price)||0}();L&&("percentage"===L.type?S=u*L.value/100:"fixed"===L.type?S=L.value:"free_shipping"===L.type&&(S=0,p=0),S>u&&(S=u));const m=u+p-S,y=m*r/(1+r);e&&(e.textContent=n.currency+u.toFixed(2)),t&&(t.textContent=n.currency+y.toFixed(2)),o&&(o.textContent=0===p?n.free||"FREE":n.currency+p.toFixed(2)),c&&i&&(S>0?(c.style.display="block",i.textContent="-"+n.currency+S.toFixed(2)):c.style.display="none"),s&&(s.textContent=n.currency+m.toFixed(2)),d&&(d.innerHTML=a.map(e=>{const t=l(e),o=e.variantName?" ("+e.variantName+")":"";return'<div class="order-item"><span>'+e.name+o+" x "+e.quantity+"</span><span>"+n.currency+(t*e.quantity).toFixed(2)+"</span></div>"}).join(""))}window.zappySelectShipping=function(e){w=b.find(t=>t.id===e),document.querySelectorAll(".shipping-option").forEach(t=>{t.classList.toggle("selected",t.dataset.methodId===e)});const t=document.getElementById("shipping-address-section");t&&(w&&w.is_pickup?t.style.display="none":t.style.display="block"),B()},window.zappyAddToCart=u,window.zappyHandleAddToCart=function(t){if(parseInt(t.variant_count||0)>0){const n="/product/"+(t.slug||t.id),o=window.location.href;if(o.includes("/api/website/preview")){const t=o.includes("preview-fullscreen")?"preview-fullscreen":"preview";window.location.href="/api/website/"+t+"/"+e+"?page="+encodeURIComponent(n)}else window.location.href=n}else u(t)},window.zappyRemoveFromCart=function(e){a=a.filter(t=>{const n=t.selectedVariant?t.selectedVariant.id:null;return(n?t.id+"-"+n:t.id)!==e}),s(),h(),g()};let _=[],x=null;function A(e){if(!e||e.length<2)return[];const t=e.toLowerCase();return _.filter(e=>e.name?.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t)||e.sku?.toLowerCase().includes(t)||e.tags?.some(e=>e.toLowerCase().includes(t))).slice(0,6)}function F(){const o=document.getElementById("nav-search-input"),a=document.getElementById("nav-search-btn"),r=document.getElementById("nav-search-results");if(o&&(async function(){try{const n=await fetch(t("/api/ecommerce/storefront/products?websiteId="+e)),o=await n.json();o.success&&o.data&&(_=o.data)}catch(e){console.error("Failed to load products for search",e)}}(),o.addEventListener("input",function(){const e=this.value.trim();clearTimeout(x),e.length<2?r&&r.classList.remove("active"):x=setTimeout(function(){!function(e,t){const o=document.getElementById("nav-search-results");if(!o)return;if(0===e.length)return o.innerHTML='<div class="search-no-results">'+(n.noProducts||"No products found")+"</div>",void o.classList.add("active");let a=e.map(e=>'<a href="/product/'+(e.slug||e.id)+'" class="search-result-item">'+(e.images?.[0]?'<img src="'+e.images[0]+'" alt="'+e.name+'" class="search-result-img">':'<div class="search-result-img"></div>')+'<div class="search-result-info"><div class="search-result-name">'+e.name+'</div><div class="search-result-price">'+n.currency+e.price+"</div></div></a>").join("");_.filter(e=>e.name?.toLowerCase().includes(t.toLowerCase())).length>6&&(a+='<a href="/products?search='+encodeURIComponent(t)+'" class="search-view-all">'+(n.viewAllResults||"View all results")+" â†’</a>"),o.innerHTML=a,o.classList.add("active")}(A(e),e)},200)}),a&&a.addEventListener("click",function(){const e=o.value.trim();e.length>=2&&(window.location.href="/products?search="+encodeURIComponent(e))}),o.addEventListener("keypress",function(e){if("Enter"===e.key){const e=this.value.trim();e.length>=2&&(window.location.href="/products?search="+encodeURIComponent(e))}}),document.addEventListener("click",function(e){r&&!e.target.closest(".nav-search-box")&&r.classList.remove("active")}),"/products"===window.location.pathname)){const e=new URLSearchParams(window.location.search).get("search");e&&(o.value=e,function(e){const t=document.getElementById("zappy-product-grid");if(!t)return;setTimeout(function(){const o=t.querySelectorAll(".product-card"),a=e.toLowerCase();let r=0;if(o.forEach(function(e){const t=e.querySelector("h3")?.textContent?.toLowerCase()||"",n=e.querySelector("p")?.textContent?.toLowerCase()||"",o=t.includes(a)||n.includes(a);e.style.display=o?"":"none",o&&r++}),0===r){const e=document.createElement("div");e.className="empty-cart",e.textContent=n.noProducts||"No products found",e.id="search-no-results",t.appendChild(e)}},500)}(e))}}function T(){const e=[".nav-menu",".mobile-menu",".mobile-nav",'[class*="mobile-menu"]','[class*="nav-menu"]',".menu-items",".nav-links","nav ul"],t=[".hamburger",".menu-toggle",".nav-toggle",".mobile-toggle",'[class*="hamburger"]','[class*="menu-toggle"]',".menu-btn",'button[aria-label*="menu"]',".mobile-menu-btn"];let n=null,o=null;for(const t of e)if(n=document.querySelector(t),n)break;for(const e of t)if(o=document.querySelector(e),o)break;function a(){return!!n&&(n.classList.contains("active")||n.classList.contains("open")||n.classList.contains("show")||n.classList.contains("visible")||n.classList.contains("is-open"))}function r(){if(!n)return;n.classList.remove("active","open","show","visible","is-open","menu-open"),document.body.classList.remove("menu-open","nav-open","mobile-menu-open");const e=n.closest("nav")||n.closest("header");e&&e.classList.remove("active","open","show","menu-open","is-open"),o&&(o.classList.remove("active","open","is-active"),o.setAttribute("aria-expanded","false"));const t=document.querySelector(".mobile-menu-overlay");t&&t.remove()}let i=a();setInterval(function(){const e=a();if(e!==i)if(i=e,e){if(!document.querySelector(".mobile-menu-overlay")){const e=document.createElement("div");e.className="mobile-menu-overlay",e.style.cssText="position:fixed;inset:0;background:rgba(0,0,0,0.3);z-index:998;",e.addEventListener("click",function(){o?o.click():r()}),document.body.appendChild(e)}}else{const e=document.querySelector(".mobile-menu-overlay");e&&e.remove()}},100),document.querySelectorAll("nav a, .nav-menu a, .mobile-menu a").forEach(function(e){e.addEventListener("click",function(){setTimeout(r,100)})}),document.querySelectorAll(".nav-ecommerce-icons a, .cart-link, .login-link").forEach(function(e){e.addEventListener("click",function(){r()})}),document.addEventListener("click",function(e){if(n&&o&&a()){const t=n.contains(e.target),a=o.contains(e.target);t||a||r()}}),document.addEventListener("keydown",function(e){"Escape"===e.key&&r()}),window.zappyCloseMobileMenu=r}function M(){const e=document.getElementById("mobile-search-toggle"),t=document.getElementById("mobile-search-panel"),o=document.getElementById("close-mobile-search"),a=document.getElementById("mobile-search-input"),r=document.getElementById("mobile-search-results");e&&t&&(e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.classList.add("active"),setTimeout(function(){a&&a.focus()},100)}),o&&o.addEventListener("click",function(){t.classList.remove("active"),a&&(a.value=""),r&&(r.innerHTML="")}),a&&(a.addEventListener("input",function(){const e=this.value.trim();clearTimeout(x),e.length<2?r&&(r.innerHTML=""):x=setTimeout(function(){!function(e,t){const o=document.getElementById("mobile-search-results");if(!o)return;if(0===e.length)return void(o.innerHTML='<div class="search-no-results">'+(n.noProducts||"No products found")+"</div>");let a=e.slice(0,8).map(function(e){const t=formatPrice(e.price),n=e.images&&e.images[0]?e.images[0]:"";return'<a href="/product/'+e.slug+'" class="search-result-item">'+(n?'<img src="'+n+'" alt="'+e.name+'" class="search-result-img">':"")+'<div class="search-result-info"><div class="search-result-name">'+e.name+'</div><div class="search-result-price">'+t+"</div></div></a>"}).join("");e.length>8&&(a+='<a href="/products?search='+encodeURIComponent(t)+'" class="search-view-all">'+(n.viewAllResults||"View all results")+" ("+e.length+")</a>");o.innerHTML=a}(A(e),e)},200)}),a.addEventListener("keypress",function(e){if("Enter"===e.key){const e=this.value.trim();e.length>=2&&(window.location.href="/products?search="+encodeURIComponent(e))}})),document.addEventListener("click",function(e){!t.classList.contains("active")||e.target.closest("#mobile-search-panel")||e.target.closest("#mobile-search-toggle")||t.classList.remove("active")}))}function q(){d(),async function(){if(!document.getElementById("zappy-product-grid"))return;const n=new URLSearchParams(window.location.search),o=n.get("page");let a=n.get("category");if(o){const e=new URL(o,window.location.origin);a=e.searchParams.get("category")||a}if(a)try{const n=await fetch(t("/api/ecommerce/storefront/categories?websiteId="+e)),o=await n.json();if(o.success&&o.data){const e=o.data.find(function(e){return e.id===a});if(e){const t=document.querySelector(".products-section"),n=t?t.querySelector("h1"):null;n&&(n.textContent=e.name),document.title=e.name+" - "+document.title.split(" - ").pop()}}}catch(e){console.warn("Failed to fetch category name",e)}y("all")}(),document.querySelectorAll(".filter-btn").forEach(function(e){e.addEventListener("click",function(){y(e.getAttribute("data-category"))})}),h(),async function(){const o=document.getElementById("shipping-methods");if(o)try{const a=await fetch(t("/api/ecommerce/storefront/shipping?websiteId="+e)),r=await a.json();if(b=r.data||[],!b.length)return void(o.innerHTML='<div class="no-shipping">'+(n.noShippingMethods||"No shipping options available")+"</div>");if(o.innerHTML=b.map((e,t)=>{const o=e.is_pickup,a=0===parseFloat(e.price),r=e.conditions?.freeAbove&&P()>=e.conditions.freeAbove,i=a||r?n.free||"FREE":n.currency+e.price,c=e.estimated_days?" ("+e.estimated_days+" "+n.days+")":"",s=o?"ğŸ“ ":"ğŸšš ",d=o&&e.pickup_address?.street?'<div class="shipping-address">'+e.pickup_address.street+", "+(e.pickup_address.city||"")+"</div>":"",l=e.conditions?.freeAbove&&!r?'<div class="shipping-free-note">'+(n.freeAbove||"Free above")+" "+n.currency+e.conditions.freeAbove+"</div>":"";return'<label class="shipping-option'+(0===t?" selected":"")+'" data-method-id="'+e.id+'"><input type="radio" name="shipping" value="'+e.id+'"'+(0===t?" checked":"")+' onchange="window.zappySelectShipping(this.value)"><div class="shipping-info"><div class="shipping-name">'+s+e.name+c+"</div>"+(e.description?'<div class="shipping-desc">'+e.description+"</div>":"")+d+l+'</div><div class="shipping-price'+(a||r?" free":"")+'">'+i+"</div></label>"}).join(""),b.length>0){w=b[0];const e=document.getElementById("shipping-address-section");e&&(e.style.display=w.is_pickup?"none":"block"),B()}}catch(e){console.error("Failed to load shipping methods",e),o.innerHTML='<div class="error">'+(n.errorLoading||"Error loading options")+"</div>"}}(),async function(){const a=document.getElementById("payment-container");if(a)try{const n=await fetch(t("/api/ecommerce/storefront/payment-status?websiteId="+e)),r=await n.json();if(C=r.data?.isConfigured||!1,E=r.data?.methods||[],!C||!E.length)return void(a.innerHTML='<div class="payment-not-configured"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg><span>'+(o?"×ª×©×œ×•× ××§×•×•×Ÿ ×œ× ××•×’×“×¨. ×¦×¨×• ×§×©×¨ ×¢× ×‘×¢×œ ×”××ª×¨.":"Online payment not configured. Please contact the store owner.")+"</span></div>");a.innerHTML=E.map((e,t)=>{const n=o?e.name:e.nameEn,a="credit-card"===e.icon?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>':"";return'<label class="payment-option'+(0===t?" selected":"")+'" data-method-id="'+e.id+'"><input type="radio" name="payment" value="'+e.id+'"'+(0===t?" checked":"")+' onchange="window.zappySelectPayment(this.value)"><div class="payment-info"><div class="payment-icon">'+a+'</div><div class="payment-name">'+n+"</div></div></label>"}).join(""),E.length>0&&(k=E[0])}catch(e){console.error("Failed to load payment methods",e),a.innerHTML='<div class="error">'+(n.errorLoading||"Error loading options")+"</div>"}}(),B(),F(),M(),T(),function(){if(window.innerWidth>768)return;const e=document.querySelectorAll('a[href="/products"], a[href*="/products"]');if(!e.length)return;const n=document.getElementById("zappy-category-links");let o=[];if(n){n.querySelectorAll("a").forEach(function(e){o.push({name:e.textContent.trim(),href:e.href})})}if(0===o.length){const n=window.ZAPPY_WEBSITE_ID;n&&fetch(t("/api/ecommerce/"+n+"/categories")).then(function(e){return e.json()}).then(function(t){t.categories&&t.categories.length>0&&(o=t.categories.map(function(e){return{name:e.name,href:"/products?category="+e.id}}),z(e,o))}).catch(function(){})}else z(e,o)}(),function(){document.querySelectorAll("#cart-drawer-toggle, [data-cart-toggle], .cart-link.nav-cart, a.nav-cart").forEach(function(e){e.hasAttribute("data-cart-init")||(e.setAttribute("data-cart-init","true"),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),f()}))});var e=document.getElementById("cart-drawer-close");e&&e.addEventListener("click",v);var t=document.getElementById("cart-drawer-overlay");t&&t.addEventListener("click",v),document.addEventListener("keydown",function(e){"Escape"===e.key&&v()}),g()}(),I(),function(){const o=document.getElementById("coupon-toggle-btn"),a=document.getElementById("coupon-input-wrapper"),r=document.getElementById("coupon-close-btn"),i=document.getElementById("apply-coupon-btn"),c=document.getElementById("remove-coupon-btn"),s=document.getElementById("coupon-code-input"),d=document.getElementById("coupon-applied-row");o&&a&&(o.addEventListener("click",function(){"none"===a.style.display&&(a.style.display="block",o.style.display="none",s&&s.focus())}),r&&r.addEventListener("click",function(){a.style.display="none",o.style.display="flex",s&&(s.value="");const e=document.getElementById("coupon-error");e&&(e.style.display="none")}),i&&s&&(i.addEventListener("click",async function(){const r=s.value.trim();if(r){i.disabled=!0,i.textContent="...";try{const i=P(),c=await fetch(t("/api/ecommerce/storefront/validate-coupon"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteId:e,code:r,subtotal:i})}),s=await c.json();if(!s.success||!s.data?.valid){const e=document.getElementById("coupon-error");let t=n.invalidCoupon||"Invalid coupon code";return"expired"===s.data?.error?t=n.couponExpired||"Coupon has expired":"min_order"===s.data?.error&&(t=(n.couponMinOrder||"Minimum order amount")+": "+n.currency+s.data.minOrderAmount),void(e&&(e.textContent=t,e.style.display="block",setTimeout(function(){e.style.display="none"},5e3)))}L=s.data.coupon,S=L.discountAmount||0,a.style.display="none",o.style.display="none",d.style.display="flex",document.getElementById("applied-coupon-code").textContent=L.code,document.getElementById("coupon-error").style.display="none",B()}catch(e){console.error("Failed to validate coupon",e);const t=document.getElementById("coupon-error");t&&(t.textContent=n.errorLoading||"Error",t.style.display="block")}finally{i.disabled=!1,i.textContent=n.applyCoupon||"Apply"}}}),s.addEventListener("keypress",function(e){"Enter"===e.key&&(e.preventDefault(),i.click())}),c&&c.addEventListener("click",function(){L=null,S=0,d.style.display="none",o.style.display="flex",s&&(s.value=""),B()})))}(),async function(){const e=window.location.pathname,o=(window.location.search.includes("page="),new URLSearchParams(window.location.search).get("page"));if("/order-success"!==e&&!e.endsWith("/order-success")&&"/order-success"!==o&&"order-success"!==o)return;try{if(window.self!==window.top)return void(window.top.location.href=window.location.href)}catch(e){try{window.parent.postMessage({type:"zappy_order_success",url:window.location.href},"*")}catch(e){console.warn("Could not communicate with parent frame:",e)}}const r=document.getElementById("order-number-value"),i=document.getElementById("order-details-section"),c=document.getElementById("order-items-list"),l=document.getElementById("order-totals-summary");if(!r)return;const u=new URLSearchParams(window.location.search).get("ref");if(!u)return void(r.textContent=n.orderNotFound||"Order not found");const p=u.split("_"),m=p.length>=3?p[2]:u;r.textContent="#"+m;const y=window.ZAPPY_WEBSITE_ID;if(y)try{const e=await fetch(t("/api/ecommerce/confirm-order/"+encodeURIComponent(u)),{method:"POST",headers:{"Content-Type":"application/json"}}),n=await e.json();n.success?(console.log("âœ… Order confirmed:",n.data),n.data.orderNumber&&(r.textContent="#"+n.data.orderNumber)):console.warn("Order confirmation response:",n)}catch(e){console.error("Failed to confirm order:",e)}if(y&&i&&c){const e="zappy_pending_order_"+u;let o=localStorage.getItem(e);if(!o)try{const e=await fetch(t("/api/ecommerce/pending-order/"+encodeURIComponent(u))),n=await e.json();n.success&&n.data&&(o=JSON.stringify(n.data))}catch(e){console.error("Failed to fetch pending order from API:",e)}if(o)try{const t=JSON.parse(o);if(i.style.display="block",t.cartItems&&t.cartItems.length>0&&(c.innerHTML=t.cartItems.map(function(e){var t=e.sale_price&&parseFloat(e.sale_price)<parseFloat(e.price)?parseFloat(e.sale_price):parseFloat(e.price),o=e.variantName?" ("+e.variantName+")":"";return'<div class="order-success-item"><span>'+e.name+o+" x "+e.quantity+"</span><span>"+n.currency+(t*e.quantity).toFixed(2)+"</span></div>"}).join("")),l){let e="<div><span>"+(n.subtotal||"Subtotal")+":</span><span>"+n.currency+parseFloat(t.subtotal||0).toFixed(2)+"</span></div>";t.shippingCost>0&&(e+="<div><span>"+(n.shipping||"Shipping")+":</span><span>"+n.currency+parseFloat(t.shippingCost).toFixed(2)+"</span></div>"),t.discount>0&&(e+="<div><span>"+(n.discount||"Discount")+":</span><span>-"+n.currency+parseFloat(t.discount).toFixed(2)+"</span></div>"),e+='<div class="order-total-final"><span>'+(n.paidAmount||"Amount Paid")+":</span><span>"+n.currency+parseFloat(t.total||0).toFixed(2)+"</span></div>",l.innerHTML=e}localStorage.removeItem(e)}catch(e){console.error("Error parsing pending order data:",e)}}a=[],s(),d()}(),function(){const a=document.getElementById("send-otp-btn"),r=document.getElementById("verify-otp-btn"),i=document.getElementById("login-email"),s=document.getElementById("otp-code"),d=document.querySelector(".login-form"),l=document.querySelector(".otp-form");if(!a||!i)return;let u="";a.addEventListener("click",async function(r){r.preventDefault();const s=c(i.value);if(s)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)){a.disabled=!0,a.textContent=o?"×©×•×œ×—...":"Sending...";try{const n=await fetch(t("/api/ecommerce/customers/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteId:e,email:s})}),a=await n.json();if(!a.success)throw new Error(a.error||"Failed to send code");u=s,d&&(d.style.display="none"),l&&(l.style.display="block"),alert(o?"×§×•×“ ××™××•×ª × ×©×œ×— ×œ××™××™×™×œ ×©×œ×š":"Verification code sent to your email")}catch(e){console.error("Send OTP failed:",e),alert(o?"×©×’×™××” ×‘×©×œ×™×—×ª ×”×§×•×“. × ×¡×” ×©×•×‘.":"Failed to send code. Please try again.")}finally{a.disabled=!1,a.textContent=n.sendCode||(o?"×©×œ×— ×§×•×“":"Send Code")}}else alert(o?"× × ×œ×”×–×™×Ÿ ×›×ª×•×‘×ª ××™××™×™×œ ×ª×§×™× ×”":"Please enter a valid email address");else alert(o?"× × ×œ×”×–×™×Ÿ ×›×ª×•×‘×ª ××™××™×™×œ":"Please enter an email address")}),r&&s&&r.addEventListener("click",async function(a){a.preventDefault();const i=s.value.trim();if(i)if(6===i.length){r.disabled=!0,r.textContent=o?"××××ª...":"Verifying...";try{const n=await fetch(t("/api/ecommerce/customers/verify-otp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({websiteId:e,email:u,code:i})}),a=await n.json();if(!a.success)throw new Error(a.error||"Invalid code");localStorage.setItem("zappy_customer_token",a.token),localStorage.setItem("zappy_customer_email",u),alert(o?"×”×ª×—×‘×¨×ª ×‘×”×¦×œ×—×”!":"Successfully logged in!");const r=sessionStorage.getItem("zappy_login_return");sessionStorage.removeItem("zappy_login_return");let c=r&&"/login"!==r?r:"/products";const s=window.location.href;if(s.includes("/api/website/preview")){const t="/api/website/"+(s.includes("preview-fullscreen")?"preview-fullscreen":"preview")+"/"+e+"?page="+encodeURIComponent(c);window.location.href=t}else window.location.href=c}catch(e){console.error("Verify OTP failed:",e),alert(o?"×§×•×“ ×©×’×•×™ ××• ×¤×’ ×ª×•×§×£. × ×¡×” ×©×•×‘.":"Invalid or expired code. Please try again.")}finally{r.disabled=!1,r.textContent=n.verify||(o?"×××ª":"Verify")}}else alert(o?"×”×§×•×“ ×—×™×™×‘ ×œ×”×™×•×ª 6 ×¡×¤×¨×•×ª":"Code must be 6 digits");else alert(o?"× × ×œ×”×–×™×Ÿ ××ª ×§×•×“ ×”××™××•×ª":"Please enter the verification code")})}(),function(){const a=document.getElementById("account-not-logged-in"),r=document.getElementById("account-logged-in"),i=document.getElementById("account-email"),c=document.getElementById("logout-btn"),s=document.getElementById("orders-loading"),d=document.getElementById("orders-empty"),l=document.getElementById("orders-list");if(!a||!r)return;const u=localStorage.getItem("zappy_customer_token"),p=localStorage.getItem("zappy_customer_email");if(!u)return a.style.display="block",void(r.style.display="none");a.style.display="none",r.style.display="block",i&&p&&(i.textContent=p),c&&c.addEventListener("click",function(){localStorage.removeItem("zappy_customer_token"),localStorage.removeItem("zappy_customer_email");const t=window.location.href;if(t.includes("/api/website/preview")){const n=t.includes("preview-fullscreen")?"preview-fullscreen":"preview";window.location.href="/api/website/"+n+"/"+e+"?page="+encodeURIComponent("/")}else window.location.href="/"}),async function(){if(s&&l)try{const e=await fetch(t("/api/ecommerce/customers/me/orders"),{headers:{Authorization:"Bearer "+u}}),a=await e.json();if(s.style.display="none",!a.success||!a.data||0===a.data.length)return void(d&&(d.style.display="block"));l.style.display="block",l.innerHTML=a.data.map(function(e){const t="status"+(e.payment_status||e.status||"pending").charAt(0).toUpperCase()+(e.payment_status||e.status||"pending").slice(1),a=n[t]||e.payment_status||e.status||"pending",r=new Date(e.created_at).toLocaleDateString(o?"he-IL":"en-US");let i=e.items;if("string"==typeof i)try{i=JSON.parse(i)}catch(e){i=[]}i=i||[];const c=parseFloat(e.total||e.total_amount||0);return'<div class="order-card"><div class="order-card-header"><span class="order-number">#'+(e.order_number||e.id.slice(0,8))+'</span><span class="order-status status-'+(e.payment_status||e.status)+'">'+a+'</span></div><div class="order-card-body"><div class="order-info-row"><span class="order-label">'+(n.orderDate||"Date")+':</span><span class="order-value">'+r+'</span></div><div class="order-info-row"><span class="order-label">'+(n.orderTotal||"Total")+':</span><span class="order-value">'+n.currency+c.toFixed(2)+"</span></div>"+(i.length>0?'<div class="order-items-summary">'+i.slice(0,3).map(function(e){return'<span class="order-item-name">'+(e.name||e.productName||"Item")+(e.quantity>1?" x"+e.quantity:"")+"</span>"}).join(", ")+(i.length>3?"...":"")+"</div>":"")+"</div></div>"}).join("")}catch(e){console.error("Failed to load orders:",e),s.style.display="none",d&&(d.querySelector("p").textContent=n.errorLoading||"Error loading orders",d.style.display="block")}}()}(),function(){const e=localStorage.getItem("zappy_customer_token"),t=document.querySelectorAll('a[href="/login"]'),n=document.querySelectorAll('a[href="/account"]');e?t.forEach(function(e){e.href="/account"}):n.forEach(function(e){e.href="/login"})}()}function z(e,t){t.length&&e.forEach(function(e){if(e.parentElement.querySelector(".mobile-categories-submenu"))return;if(!e.closest('.nav-menu, .mobile-menu, .mobile-nav, [class*="mobile"], [class*="nav-menu"]'))return;const n=document.createElement("div");n.className="mobile-categories-submenu",n.innerHTML=t.map(function(e){return'<a href="'+e.href+'">'+e.name+"</a>"}).join("");const o=e.innerHTML;e.innerHTML='<span class="products-menu-toggle">'+o+"</span>",e.classList.add("products-menu-item"),e.parentElement.insertBefore(n,e.nextSibling),e.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();const o=e.querySelector(".products-menu-toggle");o&&o.classList.toggle("active"),n.classList.toggle("active")})})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",q):q()}(),document.addEventListener("DOMContentLoaded",function(){loadFeaturedProducts(),loadFeaturedCategories(),loadCatalogCategories(),loadProductDetailPage()});